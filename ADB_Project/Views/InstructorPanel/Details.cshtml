@model ADB_Project.Models.Course

@{
    ViewData["Title"] = "Course Details";
}

<style>
    .page-header {
        background: linear-gradient(135deg, #233047 0%, #1d2533 47%);
        color: white;
        padding: 30px;
        border-radius: 15px;
        margin-bottom: 30px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }

        .page-header h2 {
            margin: 0;
            font-weight: 600;
        }

    .info-card {
        background: white;
        border-radius: 15px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        padding: 25px;
        margin-bottom: 25px;
    }

        .info-card h4 {
            color: #1e3c72;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }

    .info-row {
        display: flex;
        padding: 12px 0;
        border-bottom: 1px solid #f8f9fa;
    }

        .info-row:last-child {
            border-bottom: none;
        }

    .info-label {
        font-weight: 600;
        color: #2c3e50;
        width: 180px;
        flex-shrink: 0;
    }

    .info-value {
        color: #6c757d;
        flex-grow: 1;
    }

    .stat-card {
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        text-align: center;
        transition: all 0.3s ease;
    }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .stat-card i {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

    .stat-number {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .stat-label {
        color: #6c757d;
        font-size: 0.9rem;
    }

    .status-badge {
        font-weight: 500;
        padding: 8px 16px;
        border-radius: 20px;
        display: inline-block;
    }

    .action-buttons {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }

    .btn-custom {
        padding: 10px 20px;
        border-radius: 25px;
        font-weight: 600;
        transition: all 0.3s ease;
        border: none;
    }

    .btn-primary-custom {
        background: linear-gradient(135deg, #233047 0%, #1d2533 47%);
        color: white;
    }

        .btn-primary-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(30,60,114,0.3);
        }

    .section-card {
        background: white;
        border-radius: 15px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        padding: 25px;
        margin-bottom: 25px;
    }

        .section-card h5 {
            color: #1e3c72;
            font-weight: 600;
            margin-bottom: 20px;
        }

    .list-group-item {
        border: none;
        border-bottom: 1px solid #e9ecef;
        padding: 15px 0;
    }

        .list-group-item:last-child {
            border-bottom: none;
        }

    .empty-message {
        text-align: center;
        padding: 40px;
        color: #6c757d;
    }

        .empty-message i {
            font-size: 3rem;
            opacity: 0.3;
            margin-bottom: 15px;
        }

    .badge-custom {
        padding: 5px 10px;
        border-radius: 12px;
        font-size: 0.85rem;
    }
</style>

<div class="container mt-4">
    <!-- Page Header -->
    <div class="page-header">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h2><i class="fas fa-book me-2"></i>Course Details</h2>
                <p class="mb-0 mt-2 opacity-75">@Model.CourseName</p>
            </div>
            <a asp-action="MyCourses" class="btn btn-light btn-sm">
                <i class="fas fa-arrow-left me-2"></i>Back to Courses
            </a>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="row mb-4">
        <div class="col-md-3 mb-3">
            <div class="stat-card">
                <i class="fas fa-users text-primary"></i>
                <div class="stat-number text-primary">@(Model.StudentCourses?.Count ?? 0)</div>
                <div class="stat-label">Enrolled Students</div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="stat-card">
                <i class="fas fa-file-alt text-success"></i>
                <div class="stat-number text-success">@(Model.Exams?.Count ?? 0)</div>
                <div class="stat-label">Total Exams</div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="stat-card">
                <i class="fas fa-question-circle text-warning"></i>
                <div class="stat-number text-warning">@(Model.Questions?.Count ?? 0)</div>
                <div class="stat-label">Question Bank</div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="stat-card">
                <i class="fas fa-clock text-info"></i>
                <div class="stat-number text-info">@Model.CreditHours</div>
                <div class="stat-label">Credit Hours</div>
            </div>
        </div>
    </div>

    <!-- Course Information Card -->
    <div class="info-card">
        <h4><i class="fas fa-info-circle me-2"></i>Course Information</h4>

        <div class="info-row">
            <div class="info-label">Course Code:</div>
            <div class="info-value">
                <span class="badge bg-primary">@Model.CourseCode</span>
            </div>
        </div>

        <div class="info-row">
            <div class="info-label">Course Name:</div>
            <div class="info-value"><strong>@Model.CourseName</strong></div>
        </div>

        <div class="info-row">
            <div class="info-label">Description:</div>
            <div class="info-value">@(Model.Description ?? "No description available")</div>
        </div>

        <div class="info-row">
            <div class="info-label">Credit Hours:</div>
            <div class="info-value">@Model.CreditHours hours</div>
        </div>

        <div class="info-row">
            <div class="info-label">Status:</div>
            <div class="info-value">
                <span class="status-badge @(Model.IsActive == true ? "bg-success" : "bg-danger")">
                    @(Model.IsActive == true ? "Active" : "Inactive")
                </span>
            </div>
        </div>

       @*  @if (Model.CreatedAt != null)
        {
            <div class="info-row">
                <div class="info-label">Created Date:</div>
                <div class="info-value">@Model.CreatedAt?.ToString("MMMM dd, yyyy")</div>
            </div>
        } *@
    </div>

    <!-- Quick Actions Card -->
    <div class="info-card">
        <h4><i class="fas fa-tasks me-2"></i>Quick Actions</h4>
        <div class="action-buttons">
            <a asp-action="Questions" asp-route-courseId="@Model.CourseId" class="btn btn-info btn-custom">
                <i class="fas fa-question-circle me-2"></i>Manage Questions
            </a>
            <a asp-action="GenerateExam" asp-route-courseId="@Model.CourseId" class="btn btn-success btn-custom">
                <i class="fas fa-file-alt me-2"></i>Create New Exam
            </a>
            
        </div>
    </div>

    <div class="row">
        <!-- Enrolled Students Section -->
        <div class="col-md-6">
            <div class="section-card">
                <h5><i class="fas fa-users me-2"></i>Enrolled Students</h5>
                @if (Model.StudentCourses != null && Model.StudentCourses.Any())
                {
                    <div class="list-group">
                        @foreach (var studentCourse in Model.StudentCourses.Take(5))
                        {
                            <div class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <i class="fas fa-user-graduate text-primary me-2"></i>
                                    @* <strong>@studentCourse.Student?.FirstName @studentCourse.Student?.LastName</strong> *@
                                    <br />
                                    <small class="text-muted">@studentCourse.Student?.Email</small>
                                </div>
                                @if (studentCourse.EnrollmentDate != null)
                                {
                                    <small class="text-muted">
                                        Enrolled: @studentCourse.EnrollmentDate?.ToString("MMM dd, yyyy")
                                    </small>
                                }
                            </div>
                        }
                    </div>
                    @if (Model.StudentCourses.Count > 5)
                    {
                        <div class="text-center mt-3">
                            <small class="text-muted">Showing 5 of @Model.StudentCourses.Count students</small>
                        </div>
                    }
                }
                else
                {
                    <div class="empty-message">
                        <i class="fas fa-user-slash"></i>
                        <p>No students enrolled yet</p>
                    </div>
                }
            </div>
        </div>

        <!-- Recent Exams Section -->
        <div class="col-md-6">
            <div class="section-card">
                <h5><i class="fas fa-file-alt me-2"></i>Recent Exams</h5>
                @if (Model.Exams != null && Model.Exams.Any())
                {
                    <div class="list-group">
                        @foreach (var exam in Model.Exams.OrderByDescending(e => e.CreatedDate).Take(5))
                        {
                            <div class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <i class="fas fa-file-alt text-success me-2"></i>
                                    <strong>@exam.ExamName</strong>
                                    <br />
                                    <small class="text-muted">
                                        Questions: @(exam.ExamQuestions?.Count ?? 0) |
                                        Total Marks: @exam.TotalDegree
                                    </small>
                                </div>
                                <div class="text-end">
                                    @if (exam.CreatedDate != null)
                                    {
                                        <small class="text-muted d-block">@exam.CreatedDate?.ToString("MMM dd, yyyy")</small>
                                    }
                                  @*   <span class="badge-custom @(exam.IsActive == true ? "bg-success" : "bg-secondary")">
                                        @(exam.IsActive == true ? "Active" : "Inactive")
                                    </span> *@
                                </div>
                            </div>
                        }
                    </div>
                    @if (Model.Exams.Count > 5)
                    {
                        <div class="text-center mt-3">
                            <small class="text-muted">Showing 5 of @Model.Exams.Count exams</small>
                        </div>
                    }
                }
                else
                {
                    <div class="empty-message">
                        <i class="fas fa-file-excel"></i>
                        <p>No exams created yet</p>
                        <a asp-action="GenerateExam" asp-route-courseId="@Model.CourseId" class="btn btn-sm btn-primary-custom mt-2">
                            <i class="fas fa-plus me-2"></i>Create First Exam
                        </a>
                    </div>
                }
            </div>
        </div>
    </div>
</div>